<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>flexsdm: Red Fir example • flexsdm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="flexsdm: Red Fir example">
<meta property="og:description" content="flexsdm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexsdm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_pre_modeling.html">Overview of Pre-modeling functions</a>
    </li>
    <li>
      <a href="../articles/01_pre_modeling.html">Overview of Modeling functions</a>
    </li>
    <li>
      <a href="../articles/04_Red_fir_example.html">An example with Red Fir</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="04_Red_fir_example_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>flexsdm: Red Fir example</h1>
            
      
      
      <div class="hidden name"><code>04_Red_fir_example.Rmd</code></div>

    </div>

    
    
<div id="example-of-full-modeling-process" class="section level1">
<h1 class="hasAnchor">
<a href="#example-of-full-modeling-process" class="anchor"></a>Example of full modeling process</h1>
<div id="study-species-overview-of-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#study-species-overview-of-methods" class="anchor"></a>Study species &amp; overview of methods</h2>
<p>Here, we used the <em>flexsdm</em> package to model the current and future distribution of California red fir (<em>Abies magnifica</em>) under two climate change scenarios. Red fir is a high-elevation conifer species that’s geographic range extends through the Sierra Nevada in California into the southern portion of the Cascade Range of Oregon. For this species, we used presence data compiled by James Thorne, California Department of Fish and Wildlife, and Calflora. We built the distribution models using four climatic variables: actual evapotranspiration (CFP_1), climatic water deficit (CFP_2), maximum temperature of the warmest month (CFP_3), and minimum temperature of the coldest month (CFP_4). All variables were resampled to a 1890m spatial resolution to improve processing time.</p>
</div>
<div id="occurrence-filtering" class="section level2">
<h2 class="hasAnchor">
<a href="#occurrence-filtering" class="anchor"></a>Occurrence filtering</h2>
<p>Sample bias in species occurrence data has long been a recognized issue in SDM. However, environmental filtering of observation data can improve model predictions by reducing climatic redundancy (Varela et al. 2014). Here we will use the function occfilt_env() to thin the red fir occurrences based on environmental space. This function is unique to <em>flexsdm</em>, as it is able to use any number of environmental dimensions and does not perform a PCA before filtering. In this case, the number of unfiltered records (640) was reduced to 219 filtered records.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">flexsdm</span><span class="op">)</span>
<span class="va">somevar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"external/somevar.tif"</span>, package <span class="op">=</span> <span class="st">"flexsdm"</span><span class="op">)</span>
<span class="va">somevar</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">somevar</span><span class="op">)</span> <span class="co"># environmental data</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/names.html">names</a></span><span class="op">(</span><span class="va">somevar</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">'aet'</span>, <span class="st">'cwd'</span>, <span class="st">'tmx'</span>, <span class="st">'tmn'</span><span class="op">)</span>

<span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"external/regions.tif"</span>, package <span class="op">=</span> <span class="st">"flexsdm"</span><span class="op">)</span>
<span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html">rast</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">abies</span><span class="op">)</span>
<span class="va">abies_df</span> <span class="op">&lt;-</span> <span class="va">abies</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">pr_ab</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">pr_ab</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">somevar</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">points</a></span><span class="op">(</span><span class="va">abies_df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="04_Red_fir_example_files/figure-html/raw%20data-1.png" width="576"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">abies_df</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html">nrow</a></span><span class="op">(</span><span class="va">abies_df</span><span class="op">)</span> <span class="co"># adding unique id to each row</span>

<span class="va">abies_df2</span> <span class="op">&lt;-</span> <span class="va">abies_df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/occfilt_env.html">occfilt_env</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">.</span>,
    x <span class="op">=</span> <span class="st">'x'</span>,
    y <span class="op">=</span> <span class="st">'y'</span>,
    id <span class="op">=</span> <span class="st">'id'</span>,
    nbins <span class="op">=</span> <span class="fl">8</span>,
    env_layer <span class="op">=</span> <span class="va">somevar</span>,
    cores <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">abies_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">'id'</span>, <span class="st">'x'</span>, <span class="st">'y'</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Extracting values from raster ...</span>
<span class="co">#&gt; 27 records were removed because they have NAs for some variables</span>
<span class="co">#&gt; Number of classes in the environmental space: 6561</span>
<span class="co">#&gt; Number of unfiltered records: 673</span>
<span class="co">#&gt; Number of filtered records: 219</span>


<span class="va">somevar</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">points</a></span><span class="op">(</span><span class="va">abies_df2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="st">'x'</span>, <span class="st">'y'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="04_Red_fir_example_files/figure-html/occurrence%20filtering-1.png" width="576"></p>
</div>
<div id="block-partition-with-4-folds" class="section level2">
<h2 class="hasAnchor">
<a href="#block-partition-with-4-folds" class="anchor"></a>Block partition with 4 folds</h2>
<p>Data partitioning, or splitting data into testing and training groups, is a key step in building SDMs. <em>flexsdm</em> offers multiple options for data partitioning but here we use a spatial block method. Geographically structured data partitioning methods are especially useful if users want to evaluate model transferability to different regions or time periods. The part_sblock() function explores spatial blocks with different raster cells sizes and returns the one that is best suited for the input datset based on spatial autocorrelation, environmental similarity, and the number of presence/absence records in each block partition. The function’s output is also very useful, as it provides users with 1) a tibble with presence/absence locations and the assigned partition number, 2) a tibble with information about the best partition, and 3) a SpatRaster showing the selected grid. Here we want to divide the data into 4 different partitions using the spatial block method.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">occ_part</span> <span class="op">&lt;-</span> <span class="va">abies_df2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/part_sblock.html">part_sblock</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">.</span>,
    env_layer <span class="op">=</span> <span class="va">somevar</span>,
    pr_ab <span class="op">=</span> <span class="st">'pr_ab'</span>,
    x <span class="op">=</span> <span class="st">'x'</span>,
    y <span class="op">=</span> <span class="st">'y'</span>,
    n_part <span class="op">=</span> <span class="fl">4</span>,
    min_res_mult <span class="op">=</span> <span class="fl">3</span>,
    max_res_mult <span class="op">=</span> <span class="fl">200</span>,
    num_grids <span class="op">=</span> <span class="fl">30</span>,
    prop <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> 
<span class="co">#&gt; The following grid cell sizes will be tested:</span>
<span class="co">#&gt; 5670 | 18508.97 | 31347.93 | 44186.9 | 57025.86 | 69864.83 | 82703.79 | 95542.76 | 108381.72 | 121220.69 | 134059.66 | 146898.62 | 159737.59 | 172576.55 | 185415.52 | 198254.48 | 211093.45 | 223932.41 | 236771.38 | 249610.34 | 262449.31 | 275288.28 | 288127.24 | 300966.21 | 313805.17 | 326644.14 | 339483.1 | 352322.07 | 365161.03 | 378000</span>
<span class="co">#&gt; Creating basic raster mask...</span>
<span class="co">#&gt; Searching for the optimal grid size...</span>

<span class="va">abies_df2</span> <span class="op">&lt;-</span> <span class="va">occ_part</span><span class="op">$</span><span class="va">part</span>


<span class="co"># Trasform best block partition to a raster layer with same resolution and extent than </span>
<span class="co"># predictor variables </span>
<span class="va">block_layer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_block.html">get_block</a></span><span class="op">(</span>env_layer <span class="op">=</span> <span class="va">somevar</span>, best_grid <span class="op">=</span> <span class="va">occ_part</span><span class="op">$</span><span class="va">grid</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">block_layer</span><span class="op">)</span></code></pre></div>
<p><img src="04_Red_fir_example_files/figure-html/block%20partition-1.png" width="576"></p>
</div>
<div id="pseduo-absencebackground-points-using-partition-previously-created-as-a-mask" class="section level2">
<h2 class="hasAnchor">
<a href="#pseduo-absencebackground-points-using-partition-previously-created-as-a-mask" class="anchor"></a>Pseduo-absence/background points (using partition previously created as a mask)</h2>
<p>In this example, we only have presence data. However, most SDM methods require either pseudo-absence or background data. Here, we will use the spatial block partition we just created to generate pseudo-absence and background points.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Spatial blocks where species occurs</span>
<span class="co"># Sample background points throughout study area with random method</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/sample_background.html">sample_background</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">abies_df2</span>,
    x <span class="op">=</span> <span class="st">"x"</span>,
    y <span class="op">=</span> <span class="st">"y"</span>,
    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">abies_df2</span><span class="op">$</span><span class="va">.part</span><span class="op">==</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,
    method <span class="op">=</span> <span class="st">"random"</span>,
    rlayer <span class="op">=</span> <span class="va">block_layer</span>, 
    maskval <span class="op">=</span> <span class="va">x</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pr_ab <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">block_layer</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">points</a></span><span class="op">(</span><span class="va">bg</span><span class="op">)</span></code></pre></div>
<p><img src="04_Red_fir_example_files/figure-html/pseudo/absence%20and%20background%20data-1.png" width="576"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sdm_extract.html">sdm_extract</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bg</span>, x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'y'</span>, env_layer <span class="op">=</span> <span class="va">block_layer</span><span class="op">)</span>


<span class="co"># Sampling a number of pseudo-absences equal to the presence in each partition</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="va">psa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/sample_pseudoabs.html">sample_pseudoabs</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">abies_df2</span>,
    x <span class="op">=</span> <span class="st">"x"</span>,
    y <span class="op">=</span> <span class="st">"y"</span>,
    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">abies_df2</span><span class="op">$</span><span class="va">.part</span><span class="op">==</span><span class="va">x</span><span class="op">)</span>,
    method <span class="op">=</span> <span class="st">"random"</span>,
    rlayer <span class="op">=</span> <span class="va">block_layer</span>, 
    maskval <span class="op">=</span> <span class="va">x</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pr_ab <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>  

<span class="va">psa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sdm_extract.html">sdm_extract</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">psa</span>, x<span class="op">=</span><span class="st">'x'</span>, y<span class="op">=</span><span class="st">'y'</span>, env_layer <span class="op">=</span> <span class="va">block_layer</span><span class="op">)</span>
  
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">block_layer</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">points</a></span><span class="op">(</span><span class="va">psa</span><span class="op">)</span></code></pre></div>
<p><img src="04_Red_fir_example_files/figure-html/pseudo/absence%20and%20background%20data-2.png" width="576"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="co"># Bind a presences and pseudo-absences</span>
<span class="va">abies_df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">abies_df2</span>, <span class="va">psa</span><span class="op">)</span>


<span class="va">abies_df2</span> <span class="co"># Presence-Pseudo-absence database</span>
<span class="co">#&gt; # A tibble: 438 x 4</span>
<span class="co">#&gt;          x        y pr_ab .part</span>
<span class="co">#&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1 -12558.   68530.     1     2</span>
<span class="co">#&gt;  2 115217. -145937.     1     3</span>
<span class="co">#&gt;  3   3634.   22501.     1     2</span>
<span class="co">#&gt;  4  44972.  -60781.     1     3</span>
<span class="co">#&gt;  5 -34463.  160313.     1     4</span>
<span class="co">#&gt;  6  83108.  -27300.     1     3</span>
<span class="co">#&gt;  7 124877. -176319.     1     3</span>
<span class="co">#&gt;  8 118707. -179991.     1     3</span>
<span class="co">#&gt;  9 126141. -176302.     1     3</span>
<span class="co">#&gt; 10 -49722.  141124.     1     2</span>
<span class="co">#&gt; # ... with 428 more rows</span>
<span class="va">bg</span> <span class="co"># Backgroun points</span>
<span class="co">#&gt; # A tibble: 2,190 x 4</span>
<span class="co">#&gt;          x        y pr_ab .part</span>
<span class="co">#&gt;      &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1  41169. -235318.     0     1</span>
<span class="co">#&gt;  2  48729. -303358.     0     1</span>
<span class="co">#&gt;  3 311439. -462118.     0     1</span>
<span class="co">#&gt;  4 224499. -488578.     0     1</span>
<span class="co">#&gt;  5  35499. -344938.     0     1</span>
<span class="co">#&gt;  6 273639. -569848.     0     1</span>
<span class="co">#&gt;  7  50619. -257998.     0     1</span>
<span class="co">#&gt;  8 126219. -254218.     0     1</span>
<span class="co">#&gt;  9  67629. -394078.     0     1</span>
<span class="co">#&gt; 10 318999. -465898.     0     1</span>
<span class="co">#&gt; # ... with 2,180 more rows</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">abies_df2</span> <span class="op">&lt;-</span> <span class="va">abies_df2</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/sdm_extract.html">sdm_extract</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">.</span>,
    x <span class="op">=</span> <span class="st">'x'</span>,
    y <span class="op">=</span> <span class="st">'y'</span>,
    env_layer <span class="op">=</span> <span class="va">somevar</span>,
    filter_na <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> 

<span class="va">bg</span> <span class="op">&lt;-</span> <span class="va">bg</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/sdm_extract.html">sdm_extract</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="va">.</span>,
    x <span class="op">=</span> <span class="st">'x'</span>,
    y <span class="op">=</span> <span class="st">'y'</span>,
    env_layer <span class="op">=</span> <span class="va">somevar</span>,
    filter_na <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span> 

<span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html">plot</a></span><span class="op">(</span><span class="va">block_layer</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html">points</a></span><span class="op">(</span><span class="va">occ_part</span><span class="op">$</span><span class="va">part</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span>,
       col <span class="op">=</span> <span class="st">'black'</span>,
       cex <span class="op">=</span> <span class="fl">1</span>,
       pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></code></pre></div>
<p><img src="04_Red_fir_example_files/figure-html/extract%20environmental%20data%20for%20two%20datasets-1.png" width="576"> ## Fit models with tune_max, fit_gau, and third one Now it’s time to fit our models! The <em>flexsdm</em> package offers a wide range of modeling options, from traditional statistical methods like GLMs and GAMs, to machine learning methods like random forest and support vector machines. For each modeling method, <em>flexsdm</em> provides both fit_ and tune_ functions, which allow users to adjust hyperparameters or use default settings depending on their modeling needs. Here, we will test out tune_max() (tuned Maximum Entropy model), fit_gau() (fit Guassian Process model), and fit_glm (fit Generalized Linear Model).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># t_1 &lt;- tune_max(</span>
<span class="co">#   </span>
<span class="co"># )</span></code></pre></div>
</div>
<div id="create-an-ensemble" class="section level2">
<h2 class="hasAnchor">
<a href="#create-an-ensemble" class="anchor"></a>Create an ensemble</h2>
</div>
<div id="project-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#project-the-model" class="anchor"></a>Project the model</h2>
</div>
<div id="constrain-it-with-msdm_posterior" class="section level2">
<h2 class="hasAnchor">
<a href="#constrain-it-with-msdm_posterior" class="anchor"></a>Constrain it with msdm_posterior</h2>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Santiago J.E. Velazco, André F.A. Andrade, Brooke Rose, Ignacio Minoli, Janet Franklin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
