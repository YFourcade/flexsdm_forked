<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Sample pseudo-absences — sample_pseudoabs • flexsdm</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Sample pseudo-absences — sample_pseudoabs"><meta property="og:description" content="This function provide several methods for sampling pseudo-absences, for instance
totally random sampling method, with the options of using different environmental and or geographical constraints."><meta name="google-site-verification" content="gcou8tqRTwNjZ_Mf1kbFgAzzUcY3OF-JB2sPRPTA56I"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexsdm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/v01_pre_modeling.html">1. Overview of Pre-modeling functions</a>
    </li>
    <li>
      <a href="../articles/v02_modeling.html">2. Overview of Modeling functions</a>
    </li>
    <li>
      <a href="../articles/v03_post_modeling.html">3. Overview of Post-modeling functions</a>
    </li>
    <li>
      <a href="../articles/v04_Red_fir_example.html">4. An example with Red Fir</a>
    </li>
    <li>
      <a href="../articles/v05_Rare_species_example.html">5. Modeling a rare species</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sjevelazco/flexsdm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sample pseudo-absences</h1>
    <small class="dont-index">Source: <a href="https://github.com/sjevelazco/flexsdm/blob/HEAD/R/sample_pseudoabs.R" class="external-link"><code>R/sample_pseudoabs.R</code></a></small>
    <div class="hidden name"><code>sample_pseudoabs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function provide several methods for sampling pseudo-absences, for instance
totally random sampling method, with the options of using different environmental and or geographical constraints.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">sample_pseudoabs</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">x</span>,
  <span class="va">y</span>,
  <span class="va">n</span>,
  <span class="va">method</span>,
  <span class="va">rlayer</span>,
  maskval <span class="op">=</span> <span class="cn">NULL</span>,
  calibarea <span class="op">=</span> <span class="cn">NULL</span>,
  sp_name <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>data.frame or tibble. Database with presences
(or presence-absence, or presences-pseudo-absence) records, and coordinates</p></dd>
<dt>x</dt>
<dd><p>character. Column name with spatial x coordinates</p></dd>
<dt>y</dt>
<dd><p>character. Column name with spatial y coordinates</p></dd>
<dt>n</dt>
<dd><p>integer. Number of pseudo-absences to be sampled</p></dd>
<dt>method</dt>
<dd><p>character. Pseudo-absence allocation method. It is necessary to
provide a vector for this argument. The methods implemented are:</p><ul><li><p>random: Random allocation of pseudo-absences throughout the area used for model fitting. Usage method='random'.</p></li>
<li><p>env_const: Pseudo-absences are environmentally constrained to regions with lower suitability values predicted by a Bioclim model. For this method, it is necessary to provide a raster stack or brick object with environmental variables Usage method=c(method='env_const', env = somevar).</p></li>
<li><p>geo_const: Pseudo-absences are allocated far from occurrences based on a geographical buffer. A value of the buffer width in m must be provided if raster (used in rlayer) has a longitude/latitude CRS, or in map units in other cases. Usage method=c('geo_env_const', width='50000', env = somevar). Usage method=c('geo_const', width='50000').</p></li>
<li><p>geo_env_const: Pseudo-absences are constrained environmentally (based on Bioclim model) and distributed geographically far from occurrences based on a geographical buffer. For this method, a raster with environmental variables stored as SpatRaster object should be provided. A value of the buffer width in m must be provided if raster (used in rlayer) has a longitude/latitude CRS, or in map units in other cases. Usage method=c('geo_env_const', width='50000', env = somevar)</p></li>
<li><p>geo_env_km_const: Pseudo-absences are constrained using a three-level procedure; it is similar to the geo_env_const with an additional step which distributes the pseudo-absences in environmental space using k-means cluster analysis. For this method, it is necessary to provide a raster stack or brick object with environmental variables and a value of the buffer width in m if raster (used in rlayer) has a longitude/latitude CRS, or map units in other cases. Usage method=c('geo_env_km_const', width='50000', env = somevar)</p></li>
</ul></dd>
<dt>rlayer</dt>
<dd><p>SpatRaster. A raster layer used for sampling pseudo-absence
A layer with the same resolution and extent that environmental variables that will be used for modeling is recommended. In the case use maskval argument, this raster layer must contain the values used to constrain sampling</p></dd>
<dt>maskval</dt>
<dd><p>integer, character, or factor. Values of the raster layer used for constraining the pseudo-absence sampling</p></dd>
<dt>calibarea</dt>
<dd><p>SpatVector A SpatVector which delimit the calibration area used for a given species (see <code><a href="calib_area.html">calib_area</a></code> function).</p></dd>
<dt>sp_name</dt>
<dd><p>character. Species name for which the output will be used.
If this argument is used, the first output column will have the species name. Default NULL.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A tibble object with x y coordinates of sampled pseudo-absence points</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="sample_background.html">sample_background</a></code> and <code><a href="calib_area.html">calib_area</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/terra/" class="external-link">terra</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spp"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">somevar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/somevar.tif"</span>, package <span class="op">=</span> <span class="st">"flexsdm"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">somevar</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">somevar</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"external/regions.tif"</span>, package <span class="op">=</span> <span class="st">"flexsdm"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">single_spp</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="va">spp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"sp3"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pr_ab</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">pr_ab</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Pseudo-absences randomly sampled throughout study area</span></span>
<span class="r-in"><span class="va">ps1</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span>
<span class="r-in">    data <span class="op">=</span> <span class="va">single_spp</span>,</span>
<span class="r-in">    x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span class="r-in">    y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span class="r-in">    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span>
<span class="r-in">    method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span class="r-in">    rlayer <span class="op">=</span> <span class="va">regions</span>,</span>
<span class="r-in">    maskval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span class="r-in">    sp_name <span class="op">=</span> <span class="st">"sp3"</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span> <span class="co"># presences</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span> <span class="co"># absences</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Pseudo-absences randomly sampled within a regions where a species occurs</span></span>
<span class="r-in"><span class="co">## Regions where this species occurrs</span></span>
<span class="r-in"><span class="va">samp_here</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">regions</span>, <span class="va">single_spp</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/pkg/terra/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">ps1</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span>
<span class="r-in">    data <span class="op">=</span> <span class="va">single_spp</span>,</span>
<span class="r-in">    x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span class="r-in">    y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span class="r-in">    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span>
<span class="r-in">    method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span class="r-in">    rlayer <span class="op">=</span> <span class="va">regions</span>,</span>
<span class="r-in">    maskval <span class="op">=</span> <span class="va">samp_here</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Pseudo-absences sampled with geographical constraint</span></span>
<span class="r-in"><span class="va">ps1</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span>
<span class="r-in">    data <span class="op">=</span> <span class="va">single_spp</span>,</span>
<span class="r-in">    x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span class="r-in">    y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span class="r-in">    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span>
<span class="r-in">    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geo_const"</span>, width <span class="op">=</span> <span class="st">"30000"</span><span class="op">)</span>,</span>
<span class="r-in">    rlayer <span class="op">=</span> <span class="va">regions</span>,</span>
<span class="r-in">    maskval <span class="op">=</span> <span class="va">samp_here</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Pseudo-absences sampled with environmental constraint</span></span>
<span class="r-in"><span class="va">ps1</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span>
<span class="r-in">    data <span class="op">=</span> <span class="va">single_spp</span>,</span>
<span class="r-in">    x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span class="r-in">    y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span class="r-in">    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span>
<span class="r-in">    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"env_const"</span>, env <span class="op">=</span> <span class="va">somevar</span><span class="op">)</span>,</span>
<span class="r-in">    rlayer <span class="op">=</span> <span class="va">regions</span>,</span>
<span class="r-in">    maskval <span class="op">=</span> <span class="va">samp_here</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Pseudo-absences sampled with environmental and geographical constraint</span></span>
<span class="r-in"><span class="va">ps1</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span>
<span class="r-in">    data <span class="op">=</span> <span class="va">single_spp</span>,</span>
<span class="r-in">    x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span class="r-in">    y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span class="r-in">    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span>
<span class="r-in">    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geo_env_const"</span>, width <span class="op">=</span> <span class="st">"50000"</span>, env <span class="op">=</span> <span class="va">somevar</span><span class="op">)</span>,</span>
<span class="r-in">    rlayer <span class="op">=</span> <span class="va">regions</span>,</span>
<span class="r-in">    maskval <span class="op">=</span> <span class="va">samp_here</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Pseudo-absences sampled with environmental and geographical constraint and with k-mean clustering</span></span>
<span class="r-in"><span class="va">ps1</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span>
<span class="r-in">    data <span class="op">=</span> <span class="va">single_spp</span>,</span>
<span class="r-in">    x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span class="r-in">    y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span class="r-in">    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span>,</span>
<span class="r-in">    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"geo_env_km_const"</span>, width <span class="op">=</span> <span class="st">"50000"</span>, env <span class="op">=</span> <span class="va">somevar</span><span class="op">)</span>,</span>
<span class="r-in">    rlayer <span class="op">=</span> <span class="va">regions</span>,</span>
<span class="r-in">    maskval <span class="op">=</span> <span class="va">samp_here</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Sampling pseudo-absence using a calibration area</span></span>
<span class="r-in"><span class="va">ca_ps1</span> <span class="op">&lt;-</span> <span class="fu"><a href="calib_area.html">calib_area</a></span><span class="op">(</span></span>
<span class="r-in">  data <span class="op">=</span> <span class="va">single_spp</span>,</span>
<span class="r-in">  x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span class="r-in">  y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span class="r-in">  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"buffer"</span>, width <span class="op">=</span> <span class="fl">50000</span><span class="op">)</span>,</span>
<span class="r-in">  crs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">somevar</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ca_ps1</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">ps1</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span>
<span class="r-in">    data <span class="op">=</span> <span class="va">single_spp</span>,</span>
<span class="r-in">    x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span class="r-in">    y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span class="r-in">    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">50</span>,</span>
<span class="r-in">    method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span class="r-in">    rlayer <span class="op">=</span> <span class="va">regions</span>,</span>
<span class="r-in">    maskval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span class="r-in">    calibarea <span class="op">=</span> <span class="va">ca_ps1</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ca_ps1</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">ps1</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu">sample_pseudoabs</span><span class="op">(</span></span>
<span class="r-in">    data <span class="op">=</span> <span class="va">single_spp</span>,</span>
<span class="r-in">    x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span class="r-in">    y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span class="r-in">    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">)</span> <span class="op">*</span> <span class="fl">50</span>,</span>
<span class="r-in">    method <span class="op">=</span> <span class="st">"random"</span>,</span>
<span class="r-in">    rlayer <span class="op">=</span> <span class="va">regions</span>,</span>
<span class="r-in">    maskval <span class="op">=</span> <span class="va">samp_here</span>,</span>
<span class="r-in">    calibarea <span class="op">=</span> <span class="va">ca_ps1</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">regions</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ca_ps1</span>, add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ps1</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">single_spp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span>, cex <span class="op">=</span> <span class="fl">0.7</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Santiago J.E. Velazco, Brooke Rose, André F.A. Andrade, Ignacio Minoli, Janet Franklin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

