<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Environmental and spatial cross-validation — part_senv • flexsdm</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Environmental and spatial cross-validation — part_senv" />
<meta property="og:description" content="This function explores different numbers of environmental partitions based on the
K-mean cluster algorithm and returns the best one suited for a given presence or
presence-absences database. The selection of the best number of partition is performed
automatically considering spatial autocorrelation, environmental similarity, and the
number of presence and/or absence records in each partition." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexsdm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/01_pre_modeling.html">Overview of Pre-modeling functions</a>
    </li>
    <li>
      <a href="../articles/04_Red_fir_example.html">An example with Red Fir</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Environmental and spatial cross-validation</h1>
    
    <div class="hidden name"><code>part_senv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function explores different numbers of environmental partitions based on the
K-mean cluster algorithm and returns the best one suited for a given presence or
presence-absences database. The selection of the best number of partition is performed
automatically considering spatial autocorrelation, environmental similarity, and the
number of presence and/or absence records in each partition.</p>
    </div>

    <pre class="usage"><span class='fu'>part_senv</span><span class='op'>(</span>
  <span class='va'>env_layer</span>,
  <span class='va'>data</span>,
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  <span class='va'>pr_ab</span>,
  min_n_groups <span class='op'>=</span> <span class='fl'>2</span>,
  max_n_groups <span class='op'>=</span> <span class='fl'>10</span>,
  prop <span class='op'>=</span> <span class='fl'>0.5</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>env_layer</th>
      <td><p>SpatRaster. Raster with environmental
variable. This will be used to evaluate spatial autocorrelation and
environmental similarity between training and testing partition. Because this function
calculate dissimilarity based on euclidean distances, it can only handle continuous
layers, do not use categorical layers as inputs</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data.frame. Data.frame or tibble object with presences
(or presence-absence, or presences-pseudo-absence) records, and coordinates</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>character. Column name with longitude data</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>character. Column name with latitude data</p></td>
    </tr>
    <tr>
      <th>pr_ab</th>
      <td><p>character. Column with presences, presence-absence,
or pseudo-absence. Presences must be represented by 1 and absences by 0</p></td>
    </tr>
    <tr>
      <th>min_n_groups</th>
      <td><p>integer. Minimum number of groups to be tested. Default 2.</p></td>
    </tr>
    <tr>
      <th>max_n_groups</th>
      <td><p>integer. Maximum number of groups to be tested. Default 10.</p></td>
    </tr>
    <tr>
      <th>prop</th>
      <td><p>numeric. Proportion of point used for testing autocorrelation between
groups (values &gt; 0 and &lt;=1). The smaller this number is, the faster the function will work.
Default 0.5</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with:</p><ul>
<li><p>part: A tibble object with information used in 'data' arguments and a additional column .part with partition group.</p></li>
<li><p>best_part_info: A tibble with information of the bets partition. It contains the number of partition (n_groups), standard deviation of presences (sd_p), standard deviation of absences (sd_a), Moran's I spatial autocorrelation (spa_auto) and environmental similarity based on euclidean distance (env_sim)</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>write here criteria used for performing the search of the best partition (metrics and quartil selection).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='part_random.html'>part_random</a></code>, and <code><a href='part_sblock.html'>part_sblock</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \dontrun{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://rspatial.org/terra/'>terra</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>

<span class='va'>f</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"external/somevar.tif"</span>, package <span class='op'>=</span> <span class='st'>"flexsdm"</span><span class='op'>)</span>
<span class='va'>somevar</span> <span class='op'>&lt;-</span> <span class='fu'>terra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/rast.html'>rast</a></span><span class='op'>(</span><span class='va'>f</span><span class='op'>)</span>

<span class='co'># Select a species</span>
<span class='va'>spp1</span> <span class='op'>&lt;-</span> <span class='va'>spp</span> <span class='op'>%&gt;%</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>species</span> <span class='op'>==</span> <span class='st'>"sp1"</span><span class='op'>)</span>

<span class='va'>part1</span> <span class='op'>&lt;-</span> <span class='fu'>part_senv</span><span class='op'>(</span>
  env_layer <span class='op'>=</span> <span class='va'>somevar</span>,
  data <span class='op'>=</span> <span class='va'>spp1</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  pr_ab <span class='op'>=</span> <span class='st'>"pr_ab"</span>,
  min_n_groups <span class='op'>=</span> <span class='fl'>2</span>,
  max_n_groups <span class='op'>=</span> <span class='fl'>10</span>,
  prop <span class='op'>=</span> <span class='fl'>0.2</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>51 rows were excluded from database because NAs were found</span></div><div class='output co'>#&gt; <span class='message'>The following grid cell sizes will be tested:</span>
#&gt; <span class='message'>2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10</span></div><div class='output co'>#&gt; <span class='message'>Searching best partition...</span></div><div class='input'>
<span class='va'>part1</span>
</div><div class='output co'>#&gt; $part
#&gt; <span style='color: #949494;'># A tibble: 949 x 4</span>
#&gt;           x        y pr_ab .part
#&gt;       <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span>
#&gt; <span style='color: #BCBCBC;'> 1</span>   -<span style='color: #BB0000; text-decoration: underline;'>5</span><span style='color: #BB0000;'>541.</span> -<span style='color: #BB0000; text-decoration: underline;'>145</span><span style='color: #BB0000;'>138.</span>     0     1
#&gt; <span style='color: #BCBCBC;'> 2</span>  -<span style='color: #BB0000; text-decoration: underline;'>51</span><span style='color: #BB0000;'>981.</span>   <span style='text-decoration: underline;'>16</span>322.     0     7
#&gt; <span style='color: #BCBCBC;'> 3</span> -<span style='color: #BB0000; text-decoration: underline;'>269</span><span style='color: #BB0000;'>871.</span>   <span style='text-decoration: underline;'>69</span>512.     1     2
#&gt; <span style='color: #BCBCBC;'> 4</span>  -<span style='color: #BB0000; text-decoration: underline;'>96</span><span style='color: #BB0000;'>261.</span>  -<span style='color: #BB0000; text-decoration: underline;'>32</span><span style='color: #BB0000;'>008.</span>     0     4
#&gt; <span style='color: #BCBCBC;'> 5</span>  <span style='text-decoration: underline;'>269</span>589. -<span style='color: #BB0000; text-decoration: underline;'>566</span><span style='color: #BB0000;'>338.</span>     0     8
#&gt; <span style='color: #BCBCBC;'> 6</span>   <span style='text-decoration: underline;'>29</span>829. -<span style='color: #BB0000; text-decoration: underline;'>328</span><span style='color: #BB0000;'>468.</span>     0     6
#&gt; <span style='color: #BCBCBC;'> 7</span> -<span style='color: #BB0000; text-decoration: underline;'>152</span><span style='color: #BB0000;'>691.</span>  <span style='text-decoration: underline;'>393</span>782.     0     9
#&gt; <span style='color: #BCBCBC;'> 8</span> -<span style='color: #BB0000; text-decoration: underline;'>195</span><span style='color: #BB0000;'>081.</span>  <span style='text-decoration: underline;'>253</span>652.     0     5
#&gt; <span style='color: #BCBCBC;'> 9</span>    -<span style='color: #BB0000;'>951.</span> -<span style='color: #BB0000; text-decoration: underline;'>277</span><span style='color: #BB0000;'>978.</span>     0     6
#&gt; <span style='color: #BCBCBC;'>10</span>  <span style='text-decoration: underline;'>145</span>929. -<span style='color: #BB0000; text-decoration: underline;'>271</span><span style='color: #BB0000;'>498.</span>     0     1
#&gt; <span style='color: #949494;'># ... with 939 more rows</span>
#&gt; 
#&gt; $best_part_info
#&gt; <span style='color: #949494;'># A tibble: 1 x 6</span>
#&gt;   n_parition n_groups  sd_p  sd_a spa_auto env_sim
#&gt;        <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span>          8 9         21.3  18.4    0.644       0
#&gt; </div><div class='input'>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>part1</span><span class='op'>$</span><span class='va'>part</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>.part</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>pr_ab</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='part_senv-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>part1</span><span class='op'>$</span><span class='va'>part</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>.part</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>pr_ab</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='va'>.</span> <span class='op'>~</span> <span class='va'>.part</span><span class='op'>)</span>
</div><div class='img'><img src='part_senv-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>part1</span><span class='op'>$</span><span class='va'>part</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>.part</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>pr_ab</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='va'>.</span> <span class='op'>~</span> <span class='va'>pr_ab</span><span class='op'>)</span>
</div><div class='img'><img src='part_senv-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Santiago J.E. Velazco, André F.A. Andrade, Brooke Rose, Ignacio Minoli, Janet Franklin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


