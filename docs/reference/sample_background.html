<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Sample background points — sample_background • flexsdm</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Sample background points — sample_background" />
<meta property="og:description" content="Sampling background points with the possibility of
using different geographical restrictions and sampling method." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexsdm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/01_pre_modeling.html">Overview of Pre-modeling functions</a>
    </li>
    <li>
      <a href="../articles/04_Red_fir_example.html">An example with Red Fir</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Sample background points</h1>
    
    <div class="hidden name"><code>sample_background.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Sampling background points with the possibility of
using different geographical restrictions and sampling method.</p>
    </div>

    <pre class="usage"><span class='fu'>sample_background</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  <span class='va'>n</span>,
  method <span class='op'>=</span> <span class='st'>"random"</span>,
  <span class='va'>rlayer</span>,
  maskval <span class='op'>=</span> <span class='cn'>NULL</span>,
  calibarea <span class='op'>=</span> <span class='cn'>NULL</span>,
  rbias <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>data.frame or tibble. Database with presences records, and coordinates</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>character. Column name with longitude data</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>character. Column name with latitude data</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>integer. Number of background point to be sampled</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character. Background allocation method. The methods implemented are:</p><ul>
<li><p>random: Random allocation of background points. Usage method = 'random'.</p></li>
<li><p>thickening: Thickening background points is based on Vollering et al. (2019) method. For this method, it is necessary to define a buffer width that will be used around presences points. It possible to define a buffer using the argument as method = c("thickening", width = 20000). Buffer width must be in m if raster (used in rlayer) has a longitude/latitude CRS, or map units in other cases. If a width buffer is not provided function will use a width value equal to the mean distance of the pair-wise presences distance. In case of a width value is not provided, the argument must be used as method='thickening'.</p></li>
</ul><p>Usage method='thickening' or method = c("thickening", width = 20000). Default 'random'</p></td>
    </tr>
    <tr>
      <th>rlayer</th>
      <td><p>SpatRaster used for sampling background points.
It is recommended to use a layer with the same resolution and extent that environmental variables that will be used for modeling. In the case use maskval argument, this raster layer must contain the values to sampling constraint</p></td>
    </tr>
    <tr>
      <th>maskval</th>
      <td><p>integer or numeric. Values of the raster layer used for constraining the background points sampling</p></td>
    </tr>
    <tr>
      <th>calibarea</th>
      <td><p>SpatVect that delimits the calibration area used for a given species (see calib_area function).</p></td>
    </tr>
    <tr>
      <th>rbias</th>
      <td><p>SpatRaster used for bias background points. When use 'biased' method must be provided the raster with
with bias data. It is recommended that rbias match resolution and extent of rlayer.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A tibble object with x y coordinates of sampled background points</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Vollering, J., Halvorsen, R., Auestad, I., &amp; Rydgren, K. (2019). Bunching up the background betters bias in species distribution models. Ecography, 42(10), 1717-1727. https://doi.org/10.1111/ecog.04503</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='sample_pseudoabs.html'>sample_pseudoabs</a></code> and <code><a href='calib_area.html'>calib_area</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \dontrun{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>spp</span><span class='op'>)</span>
<span class='va'>somevar</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"external/somevar.tif"</span>, package <span class='op'>=</span> <span class='st'>"flexsdm"</span><span class='op'>)</span>
<span class='va'>somevar</span> <span class='op'>&lt;-</span> <span class='fu'>terra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/rast.html'>rast</a></span><span class='op'>(</span><span class='va'>somevar</span><span class='op'>)</span>

<span class='co'># Lest practice with a single species</span>
<span class='va'>spp_pa</span> <span class='op'>&lt;-</span> <span class='va'>spp</span> <span class='op'>%&gt;%</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>species</span> <span class='op'>==</span> <span class='st'>"sp3"</span><span class='op'>)</span>

<span class='co'>#</span>
<span class='va'>part</span> <span class='op'>&lt;-</span> <span class='fu'><a href='part_sblock.html'>part_sblock</a></span><span class='op'>(</span>
  env_layer <span class='op'>=</span> <span class='va'>somevar</span>,
  data <span class='op'>=</span> <span class='va'>spp_pa</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  pr_ab <span class='op'>=</span> <span class='st'>"pr_ab"</span>,
  min_res_mult <span class='op'>=</span> <span class='fl'>100</span>,
  max_res_mult <span class='op'>=</span> <span class='fl'>500</span>,
  num_grids <span class='op'>=</span> <span class='fl'>10</span>,
  n_part <span class='op'>=</span> <span class='fl'>2</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>4 rows were excluded from database because NAs were found</span></div><div class='output co'>#&gt; <span class='message'>The following grid cell sizes will be tested:</span>
#&gt; <span class='message'>189000 | 273000 | 357000 | 441000 | 525000 | 609000 | 693000 | 777000 | 861000 | 945000</span></div><div class='output co'>#&gt; <span class='message'>Creating basic raster mask...</span></div><div class='output co'>#&gt; <span class='message'>Searching for the optimal grid size...</span></div><div class='input'>
<span class='va'>grid_env</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_block.html'>get_block</a></span><span class='op'>(</span>env_layer <span class='op'>=</span> <span class='va'>somevar</span>, best_grid <span class='op'>=</span> <span class='va'>part</span><span class='op'>$</span><span class='va'>grid</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>grid_env</span><span class='op'>)</span>
</div><div class='input'>

<span class='co'>## %######################################################%##</span>
<span class='co'>#                                                          #</span>
<span class='co'>####             Random background method               ####</span>
<span class='co'>#                                                          #</span>
<span class='co'>## %######################################################%##</span>

<span class='co'># Sample background points throughout study area with random method</span>
<span class='va'>spp_p</span> <span class='op'>&lt;-</span> <span class='va'>spp_pa</span> <span class='op'>%&gt;%</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>pr_ab</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>bg</span> <span class='op'>&lt;-</span>
  <span class='fu'>sample_background</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>spp_p</span>,
    x <span class='op'>=</span> <span class='st'>"x"</span>,
    y <span class='op'>=</span> <span class='st'>"y"</span>,
    n <span class='op'>=</span> <span class='fl'>1000</span>,
    method <span class='op'>=</span> <span class='st'>"random"</span>,
    rlayer <span class='op'>=</span> <span class='va'>grid_env</span>
  <span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>grid_env</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='va'>bg</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Sample random background points constrained to a region with a give set of values</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>grid_env</span><span class='op'>)</span>
</div><div class='input'><span class='fu'>sample_background</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>spp_p</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  n <span class='op'>=</span> <span class='fl'>1000</span>,
  method <span class='op'>=</span> <span class='st'>"random"</span>,
  rlayer <span class='op'>=</span> <span class='va'>grid_env</span>,
  maskval <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>grid_env</span><span class='op'>)</span>
</div><div class='input'><span class='fu'>sample_background</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>spp_p</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  n <span class='op'>=</span> <span class='fl'>1000</span>,
  method <span class='op'>=</span> <span class='st'>"random"</span>,
  rlayer <span class='op'>=</span> <span class='va'>grid_env</span>,
  maskval <span class='op'>=</span> <span class='fl'>2</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>grid_env</span><span class='op'>)</span>
</div><div class='input'><span class='fu'>sample_background</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>spp_p</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  n <span class='op'>=</span> <span class='fl'>1000</span>,
  method <span class='op'>=</span> <span class='st'>"random"</span>,
  rlayer <span class='op'>=</span> <span class='va'>grid_env</span>,
  maskval <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Sample random background within a calibration area and constrained to a region</span>
<span class='va'>ca_ps1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='calib_area.html'>calib_area</a></span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>spp_pa</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='st'>"buffer"</span>, width <span class='op'>=</span> <span class='fl'>50000</span><span class='op'>)</span>,
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>grid_env</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>ca_ps1</span>, add <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='va'>spp_pa</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='st'>"blue"</span>, cex <span class='op'>=</span> <span class='fl'>0.7</span>, pch <span class='op'>=</span> <span class='fl'>19</span><span class='op'>)</span>
</div><div class='input'><span class='fu'>sample_background</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>spp_p</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  n <span class='op'>=</span> <span class='fl'>1000</span>,
  method <span class='op'>=</span> <span class='st'>"random"</span>,
  rlayer <span class='op'>=</span> <span class='va'>grid_env</span>,
  maskval <span class='op'>=</span> <span class='fl'>1</span>,
  calibarea <span class='op'>=</span> <span class='va'>ca_ps1</span>
<span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-5.png' alt='' width='700' height='433' /></div><div class='input'>


<span class='co'>## %######################################################%##</span>
<span class='co'>#                                                          #</span>
<span class='co'>####            Thickening background method            ####</span>
<span class='co'>#                                                          #</span>
<span class='co'>## %######################################################%##</span>

<span class='co'># Thickening background without containing them</span>
<span class='va'>spp_p</span> <span class='co'># presences database of a species</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 13 x 4</span>
#&gt;    species        x        y pr_ab
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>      <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'> 1</span> sp3      -<span style='color: #BB0000; text-decoration: underline;'>26</span><span style='color: #BB0000;'>331.</span>  <span style='text-decoration: underline;'>209</span>912.     1
#&gt; <span style='color: #BCBCBC;'> 2</span> sp3     -<span style='color: #BB0000; text-decoration: underline;'>134</span><span style='color: #BB0000;'>331.</span>  <span style='text-decoration: underline;'>195</span>332.     1
#&gt; <span style='color: #BCBCBC;'> 3</span> sp3      <span style='text-decoration: underline;'>131</span>079. -<span style='color: #BB0000; text-decoration: underline;'>140</span><span style='color: #BB0000;'>548.</span>     1
#&gt; <span style='color: #BCBCBC;'> 4</span> sp3      -<span style='color: #BB0000; text-decoration: underline;'>27</span><span style='color: #BB0000;'>411.</span>  <span style='text-decoration: underline;'>124</span>322.     1
#&gt; <span style='color: #BCBCBC;'> 5</span> sp3      <span style='text-decoration: underline;'>106</span>509.  -<span style='color: #BB0000; text-decoration: underline;'>83</span><span style='color: #BB0000;'>308.</span>     1
#&gt; <span style='color: #BCBCBC;'> 6</span> sp3      -<span style='color: #BB0000; text-decoration: underline;'>86</span><span style='color: #BB0000;'>811.</span>  <span style='text-decoration: underline;'>259</span>052.     1
#&gt; <span style='color: #BCBCBC;'> 7</span> sp3      <span style='text-decoration: underline;'>134</span>049. -<span style='color: #BB0000; text-decoration: underline;'>154</span><span style='color: #BB0000;'>588.</span>     1
#&gt; <span style='color: #BCBCBC;'> 8</span> sp3     -<span style='color: #BB0000; text-decoration: underline;'>124</span><span style='color: #BB0000;'>881.</span>  <span style='text-decoration: underline;'>263</span>372.     1
#&gt; <span style='color: #BCBCBC;'> 9</span> sp3      -<span style='color: #BB0000; text-decoration: underline;'>71</span><span style='color: #BB0000;'>151.</span>  <span style='text-decoration: underline;'>213</span>152.     1
#&gt; <span style='color: #BCBCBC;'>10</span> sp3        <span style='text-decoration: underline;'>2</span>289.    <span style='text-decoration: underline;'>9</span>572.     1
#&gt; <span style='color: #BCBCBC;'>11</span> sp3       <span style='text-decoration: underline;'>31</span>989.   <span style='text-decoration: underline;'>37</span>922.     1
#&gt; <span style='color: #BCBCBC;'>12</span> sp3      -<span style='color: #BB0000; text-decoration: underline;'>49</span><span style='color: #BB0000;'>551.</span>  <span style='text-decoration: underline;'>214</span>232.     1
#&gt; <span style='color: #BCBCBC;'>13</span> sp3       -<span style='color: #BB0000; text-decoration: underline;'>4</span><span style='color: #BB0000;'>461.</span>  <span style='text-decoration: underline;'>176</span>702.     1</div><div class='input'><span class='va'>grid_env</span> <span class='co'># The raster layer used for sampling background</span>
</div><div class='output co'>#&gt; class       : SpatRaster 
#&gt; dimensions  : 558, 394, 1  (nrow, ncol, nlyr)
#&gt; resolution  : 1890, 1890  (x, y)
#&gt; extent      : -373685.8, 370974.2, -604813.3, 449806.7  (xmin, xmax, ymin, ymax)
#&gt; coord. ref. : +proj=aea +lat_0=0 +lon_0=-120 +lat_1=34 +lat_2=40.5 +x_0=0 +y_0=-4000000 +datum=NAD83 +units=m +no_defs 
#&gt; source      : memory 
#&gt; name        : .part 
#&gt; min value   :     1 
#&gt; max value   :     2 </div><div class='input'><span class='va'>bg</span> <span class='op'>&lt;-</span> <span class='fu'>sample_background</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>spp_p</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  n <span class='op'>=</span> <span class='fl'>5000</span>,
  method <span class='op'>=</span> <span class='st'>"thickening"</span>,
  rlayer <span class='op'>=</span> <span class='va'>grid_env</span>,
<span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>grid_env</span><span class='op'>)</span>
</div><div class='input'><span class='va'>bg</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-6.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># Thickening background without using a given buffer width</span>
<span class='va'>spp_p</span> <span class='co'># presences database of a species</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 13 x 4</span>
#&gt;    species        x        y pr_ab
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>      <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'> 1</span> sp3      -<span style='color: #BB0000; text-decoration: underline;'>26</span><span style='color: #BB0000;'>331.</span>  <span style='text-decoration: underline;'>209</span>912.     1
#&gt; <span style='color: #BCBCBC;'> 2</span> sp3     -<span style='color: #BB0000; text-decoration: underline;'>134</span><span style='color: #BB0000;'>331.</span>  <span style='text-decoration: underline;'>195</span>332.     1
#&gt; <span style='color: #BCBCBC;'> 3</span> sp3      <span style='text-decoration: underline;'>131</span>079. -<span style='color: #BB0000; text-decoration: underline;'>140</span><span style='color: #BB0000;'>548.</span>     1
#&gt; <span style='color: #BCBCBC;'> 4</span> sp3      -<span style='color: #BB0000; text-decoration: underline;'>27</span><span style='color: #BB0000;'>411.</span>  <span style='text-decoration: underline;'>124</span>322.     1
#&gt; <span style='color: #BCBCBC;'> 5</span> sp3      <span style='text-decoration: underline;'>106</span>509.  -<span style='color: #BB0000; text-decoration: underline;'>83</span><span style='color: #BB0000;'>308.</span>     1
#&gt; <span style='color: #BCBCBC;'> 6</span> sp3      -<span style='color: #BB0000; text-decoration: underline;'>86</span><span style='color: #BB0000;'>811.</span>  <span style='text-decoration: underline;'>259</span>052.     1
#&gt; <span style='color: #BCBCBC;'> 7</span> sp3      <span style='text-decoration: underline;'>134</span>049. -<span style='color: #BB0000; text-decoration: underline;'>154</span><span style='color: #BB0000;'>588.</span>     1
#&gt; <span style='color: #BCBCBC;'> 8</span> sp3     -<span style='color: #BB0000; text-decoration: underline;'>124</span><span style='color: #BB0000;'>881.</span>  <span style='text-decoration: underline;'>263</span>372.     1
#&gt; <span style='color: #BCBCBC;'> 9</span> sp3      -<span style='color: #BB0000; text-decoration: underline;'>71</span><span style='color: #BB0000;'>151.</span>  <span style='text-decoration: underline;'>213</span>152.     1
#&gt; <span style='color: #BCBCBC;'>10</span> sp3        <span style='text-decoration: underline;'>2</span>289.    <span style='text-decoration: underline;'>9</span>572.     1
#&gt; <span style='color: #BCBCBC;'>11</span> sp3       <span style='text-decoration: underline;'>31</span>989.   <span style='text-decoration: underline;'>37</span>922.     1
#&gt; <span style='color: #BCBCBC;'>12</span> sp3      -<span style='color: #BB0000; text-decoration: underline;'>49</span><span style='color: #BB0000;'>551.</span>  <span style='text-decoration: underline;'>214</span>232.     1
#&gt; <span style='color: #BCBCBC;'>13</span> sp3       -<span style='color: #BB0000; text-decoration: underline;'>4</span><span style='color: #BB0000;'>461.</span>  <span style='text-decoration: underline;'>176</span>702.     1</div><div class='input'><span class='va'>grid_env</span> <span class='co'># The raster layer used for sampling background</span>
</div><div class='output co'>#&gt; class       : SpatRaster 
#&gt; dimensions  : 558, 394, 1  (nrow, ncol, nlyr)
#&gt; resolution  : 1890, 1890  (x, y)
#&gt; extent      : -373685.8, 370974.2, -604813.3, 449806.7  (xmin, xmax, ymin, ymax)
#&gt; coord. ref. : +proj=aea +lat_0=0 +lon_0=-120 +lat_1=34 +lat_2=40.5 +x_0=0 +y_0=-4000000 +datum=NAD83 +units=m +no_defs 
#&gt; source      : memory 
#&gt; name        : .part 
#&gt; min value   :     1 
#&gt; max value   :     2 </div><div class='input'><span class='va'>bg</span> <span class='op'>&lt;-</span> <span class='fu'>sample_background</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>spp_p</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  n <span class='op'>=</span> <span class='fl'>5000</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='st'>"thickening"</span>, width <span class='op'>=</span> <span class='fl'>150000</span><span class='op'>)</span>,
  rlayer <span class='op'>=</span> <span class='va'>grid_env</span>
<span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>grid_env</span><span class='op'>)</span>
</div><div class='input'><span class='va'>bg</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Sample thickening background within a calibration area and constrained to a region</span>
<span class='va'>bg</span> <span class='op'>&lt;-</span> <span class='fu'>sample_background</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>spp_p</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  n <span class='op'>=</span> <span class='fl'>3000</span>,
  method <span class='op'>=</span> <span class='st'>"thickening"</span>,
  rlayer <span class='op'>=</span> <span class='va'>grid_env</span>,
  maskval <span class='op'>=</span> <span class='fl'>2</span>,
  calibarea <span class='op'>=</span> <span class='va'>ca_ps1</span>
<span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>grid_env</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>ca_ps1</span>, add <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
</div><div class='input'><span class='va'>bg</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"red"</span>, cex <span class='op'>=</span> <span class='fl'>0.3</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='va'>spp_p</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span><span class='op'>]</span>, pch <span class='op'>=</span> <span class='fl'>19</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## %######################################################%##</span>
<span class='co'>#                                                          #</span>
<span class='co'>####             Biased background method               ####</span>
<span class='co'>#                                                          #</span>
<span class='co'>## %######################################################%##</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://rspatial.org/terra/'>terra</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>spp</span><span class='op'>)</span>

<span class='co'># Lets select the presences of a species</span>
<span class='va'>spp_p</span> <span class='op'>&lt;-</span> <span class='va'>spp</span> <span class='op'>%&gt;%</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>species</span> <span class='op'>==</span> <span class='st'>"sp1"</span>, <span class='va'>pr_ab</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'># Raster layer with density of poinst to obtain a biased sampling background</span>
<span class='va'>occ_density</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"external/occ_density.tif"</span>, package <span class='op'>=</span> <span class='st'>"flexsdm"</span><span class='op'>)</span>
<span class='va'>occ_density</span> <span class='op'>&lt;-</span> <span class='fu'>terra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/rast.html'>rast</a></span><span class='op'>(</span><span class='va'>occ_density</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>occ_density</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='va'>spp_p</span> <span class='op'>%&gt;%</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>, cex <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-9.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># A layer with region used to contraint background</span>
<span class='va'>regions</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"external/regions.tif"</span>, package <span class='op'>=</span> <span class='st'>"flexsdm"</span><span class='op'>)</span>
<span class='va'>regions</span> <span class='op'>&lt;-</span> <span class='fu'>terra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/rast.html'>rast</a></span><span class='op'>(</span><span class='va'>regions</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>regions</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='va'>spp_p</span> <span class='op'>%&gt;%</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span>, cex <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-10.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># Biased background points</span>
<span class='va'>spp_p</span> <span class='co'># presences database of a species</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 250 x 4</span>
#&gt;    species        x        y pr_ab
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>      <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'> 1</span> sp1     -<span style='color: #BB0000; text-decoration: underline;'>269</span><span style='color: #BB0000;'>871.</span>   <span style='text-decoration: underline;'>69</span>512.     1
#&gt; <span style='color: #BCBCBC;'> 2</span> sp1     -<span style='color: #BB0000; text-decoration: underline;'>149</span><span style='color: #BB0000;'>991.</span>  <span style='text-decoration: underline;'>267</span>962.     1
#&gt; <span style='color: #BCBCBC;'> 3</span> sp1     -<span style='color: #BB0000; text-decoration: underline;'>126</span><span style='color: #BB0000;'>231.</span>  <span style='text-decoration: underline;'>196</span>142.     1
#&gt; <span style='color: #BCBCBC;'> 4</span> sp1       <span style='text-decoration: underline;'>91</span>659. -<span style='color: #BB0000; text-decoration: underline;'>156</span><span style='color: #BB0000;'>748.</span>     1
#&gt; <span style='color: #BCBCBC;'> 5</span> sp1     -<span style='color: #BB0000; text-decoration: underline;'>210</span><span style='color: #BB0000;'>471.</span>  <span style='text-decoration: underline;'>326</span>282.     1
#&gt; <span style='color: #BCBCBC;'> 6</span> sp1     -<span style='color: #BB0000; text-decoration: underline;'>140</span><span style='color: #BB0000;'>541.</span>  <span style='text-decoration: underline;'>284</span>972.     1
#&gt; <span style='color: #BCBCBC;'> 7</span> sp1     -<span style='color: #BB0000; text-decoration: underline;'>217</span><span style='color: #BB0000;'>491.</span>   <span style='text-decoration: underline;'>65</span>732.     1
#&gt; <span style='color: #BCBCBC;'> 8</span> sp1     -<span style='color: #BB0000; text-decoration: underline;'>201</span><span style='color: #BB0000;'>831.</span>   <span style='text-decoration: underline;'>17</span>132.     1
#&gt; <span style='color: #BCBCBC;'> 9</span> sp1      -<span style='color: #BB0000; text-decoration: underline;'>40</span><span style='color: #BB0000;'>101.</span>  <span style='text-decoration: underline;'>150</span>782.     1
#&gt; <span style='color: #BCBCBC;'>10</span> sp1     -<span style='color: #BB0000; text-decoration: underline;'>178</span><span style='color: #BB0000;'>611.</span>  <span style='text-decoration: underline;'>225</span>032.     1
#&gt; <span style='color: #949494;'># ... with 240 more rows</span></div><div class='input'><span class='va'>bg</span> <span class='op'>&lt;-</span> <span class='fu'>sample_background</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>spp_p</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  n <span class='op'>=</span> <span class='fl'>3000</span>,
  method <span class='op'>=</span> <span class='st'>"biased"</span>,
  rlayer <span class='op'>=</span> <span class='va'>regions</span>,
  rbias <span class='op'>=</span> <span class='va'>occ_density</span>
<span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>occ_density</span><span class='op'>)</span>
</div><div class='input'><span class='va'>bg</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"red"</span>, cex <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>
</div><div class='input'><span class='va'>spp_p</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='va'>.</span>, col <span class='op'>=</span> <span class='st'>"black"</span>, pch <span class='op'>=</span> <span class='fl'>19</span>, cex <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-11.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># Biased background points constrained in a region</span>
<span class='co'># It will be selected region 6</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>regions</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-12.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>regions</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-13.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>bg</span> <span class='op'>&lt;-</span> <span class='fu'>sample_background</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>spp_p</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  n <span class='op'>=</span> <span class='fl'>500</span>,
  method <span class='op'>=</span> <span class='st'>"biased"</span>,
  rlayer <span class='op'>=</span> <span class='va'>regions</span>,
  rbias <span class='op'>=</span> <span class='va'>occ_density</span>,
  maskval <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>occ_density</span><span class='op'>)</span>
</div><div class='input'><span class='va'>bg</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"red"</span>, cex <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</div><div class='input'><span class='va'>spp_p</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='va'>.</span>, col <span class='op'>=</span> <span class='st'>"black"</span>, pch <span class='op'>=</span> <span class='fl'>19</span>, cex <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</div><div class='img'><img src='sample_background-14.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Santiago J.E. Velazco, André F.A. Andrade, Brooke Rose, Ignacio Minoli, Janet Franklin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


