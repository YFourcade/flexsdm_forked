<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Spatial block cross validation — part_spat • flexsdm</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Spatial block cross validation — part_spat" />
<meta property="og:description" content="This function explores spatial blocks with different cell sizes and returns the
best one suited for a given presence or presence-absences database. The selection of the best
grid size is performed automatically considering spatial autocorrelation, environmental
similarity, and the number of presence and absence records in each partition." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">flexsdm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Spatial block cross validation</h1>
    
    <div class="hidden name"><code>part_spat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function explores spatial blocks with different cell sizes and returns the
best one suited for a given presence or presence-absences database. The selection of the best
grid size is performed automatically considering spatial autocorrelation, environmental
similarity, and the number of presence and absence records in each partition.</p>
    </div>

    <pre class="usage"><span class='fu'>part_spat</span><span class='op'>(</span>
  <span class='va'>env_layer</span>,
  <span class='va'>data</span>,
  <span class='va'>x</span>,
  <span class='va'>y</span>,
  <span class='va'>pr_ab</span>,
  n_part <span class='op'>=</span> <span class='fl'>3</span>,
  min_res_mult <span class='op'>=</span> <span class='fl'>3</span>,
  max_res_mult <span class='op'>=</span> <span class='fl'>200</span>,
  num_grids <span class='op'>=</span> <span class='fl'>30</span>,
  prop <span class='op'>=</span> <span class='fl'>0.5</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>env_layer</th>
      <td><p>SpatRaster. Raster with environmental
variable. This will be used to evaluate spatial autocorrelation and
environmental similarity between training and testing partition. Because this function
calculate dissimilarity based on euclidean distances, it can only handle continuous
layers, do not use categorical layers as inputs</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data.frame. Data.frame or tibble object with presences
(or presence-absence, or presences-pseudo-absence) records, and coordinates</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>character. Column name with longitude data</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>character. Column name with latitude data</p></td>
    </tr>
    <tr>
      <th>pr_ab</th>
      <td><p>character. Column with presences, presence-absence,
or pseudo-absence. Presences must be represented by 1 and absences by 0</p></td>
    </tr>
    <tr>
      <th>n_part</th>
      <td><p>integer. Number of partition. Default 2, values other than
2 has not yet been implemented.</p></td>
    </tr>
    <tr>
      <th>min_res_mult</th>
      <td><p>integer. Minimum value used for multiplying
raster resolution and define the finest resolution to be tested, default 3.</p></td>
    </tr>
    <tr>
      <th>max_res_mult</th>
      <td><p>integer. Maximum value used for multiplying
raster resolution and define the coarsest resolution to be tested, default 200.</p></td>
    </tr>
    <tr>
      <th>num_grids</th>
      <td><p>integer. Number of grid to be tested between
min_res_mult X (raster resolution) and max_res_mult X (raster resolution), default 30</p></td>
    </tr>
    <tr>
      <th>prop</th>
      <td><p>numeric. Proportion of point used for testing autocorrelation between
groups (values &gt; 0 and &lt;=1). The smaller this number is, the faster the function will work.
Default 0.5</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with:</p><ul>
<li><p>part: A tibble object with information used in 'data' arguments and a additional column .part with partition group.</p></li>
<li><p>best_part_info: A tibble with information of the bets partition. It contains the number of the best partition (n_grid), cell size (cell_size), standard deviation of presences (sd_p), standard deviation of absences (sd_a), Moran's I spatial autocorrelation (spa_auto), and environmental similarity based on euclidean distance (env_sim).</p></li>
<li><p>grid: A SpatRaster object with blocks</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='part.html'>part</a></code>, <code><a href='part_env.html'>part_env</a></code>, <code><a href='get_block.html'>get_block</a></code>, and <code><a href='plot_res.html'>plot_res</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://rspatial.org/terra'>terra</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>

<span class='co'># Load datasets</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>spp</span><span class='op'>)</span>
<span class='va'>f</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"external/somevar.tif"</span>, package <span class='op'>=</span> <span class='st'>"flexsdm"</span><span class='op'>)</span>
<span class='va'>somevar</span> <span class='op'>&lt;-</span> <span class='fu'>terra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/rast.html'>rast</a></span><span class='op'>(</span><span class='va'>f</span><span class='op'>)</span>

<span class='co'># Lest practice with a single species</span>
<span class='va'>single_spp</span> <span class='op'>&lt;-</span> <span class='va'>spp</span> <span class='op'>%&gt;%</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>species</span> <span class='op'>==</span> <span class='st'>"sp3"</span><span class='op'>)</span>
<span class='va'>part</span> <span class='op'>&lt;-</span> <span class='fu'>part_spat</span><span class='op'>(</span>
  env_layer <span class='op'>=</span> <span class='va'>somevar</span>,
  data <span class='op'>=</span> <span class='va'>single_spp</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  pr_ab <span class='op'>=</span> <span class='st'>"pr_ab"</span>,
  min_res_mult <span class='op'>=</span> <span class='fl'>10</span>,
  max_res_mult <span class='op'>=</span> <span class='fl'>500</span>,
  num_grids <span class='op'>=</span> <span class='fl'>30</span>,
  n_part <span class='op'>=</span> <span class='fl'>2</span>,
  prop <span class='op'>=</span> <span class='fl'>0.5</span>
<span class='op'>)</span>
<span class='va'>part</span>

<span class='va'>part</span><span class='op'>$</span><span class='va'>part</span>
<span class='va'>part</span><span class='op'>$</span><span class='va'>best_part_info</span>
<span class='va'>part</span><span class='op'>$</span><span class='va'>grid</span>

<span class='co'># Lets explore Grid object</span>

<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>part</span><span class='op'>$</span><span class='va'>grid</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='va'>part</span><span class='op'>$</span><span class='va'>part</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span><span class='op'>]</span>,
       col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>, <span class='st'>"red"</span><span class='op'>)</span><span class='op'>[</span><span class='va'>part</span><span class='op'>$</span><span class='va'>part</span><span class='op'>$</span><span class='va'>.part</span><span class='op'>]</span>,
       cex <span class='op'>=</span> <span class='fl'>0.5</span>,
       pch <span class='op'>=</span> <span class='fl'>19</span>
<span class='op'>)</span>

<span class='fu'>terra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/dimensions.html'>res</a></span><span class='op'>(</span><span class='va'>part</span><span class='op'>$</span><span class='va'>grid</span><span class='op'>)</span>
<span class='fu'>terra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/dimensions.html'>res</a></span><span class='op'>(</span><span class='va'>somevar</span><span class='op'>)</span>

<span class='co'># Note that is a layer with block partition, but it has a</span>
<span class='co'># different resolution than the original environmental variables.</span>
<span class='co'># In the case you wish have a layer with the same properties</span>
<span class='co'># (i.e. resolution, extent, NAs) than your original environmental</span>
<span class='co'># variables you can use the \code{\link{get_block}} function.</span>

<span class='va'>grid_env</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_block.html'>get_block</a></span><span class='op'>(</span>env_layer <span class='op'>=</span> <span class='va'>somevar</span>, best_grid <span class='op'>=</span> <span class='va'>part</span><span class='op'>$</span><span class='va'>grid</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>grid_env</span><span class='op'>)</span> <span class='co'># this is a block layer with the same layer</span>
<span class='co'># properties as environmental variables.</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='va'>part</span><span class='op'>$</span><span class='va'>part</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span><span class='op'>]</span>,
       col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>, <span class='st'>"red"</span><span class='op'>)</span><span class='op'>[</span><span class='va'>part</span><span class='op'>$</span><span class='va'>part</span><span class='op'>$</span><span class='va'>.part</span><span class='op'>]</span>,
       cex <span class='op'>=</span> <span class='fl'>0.5</span>,
       pch <span class='op'>=</span> <span class='fl'>19</span>
<span class='op'>)</span>
<span class='co'># This layer could be very useful in case you need sample</span>
<span class='co'># pseudo_absence or background point</span>
<span class='co'># See examples in \code{\link{backgroudp}} and \code{\link{pseudoabs}}</span>


<span class='co'># Lest try with a higher number of partition</span>
<span class='va'>part</span> <span class='op'>&lt;-</span> <span class='fu'>part_spat</span><span class='op'>(</span>
  env_layer <span class='op'>=</span> <span class='va'>somevar</span>,
  data <span class='op'>=</span> <span class='va'>single_spp</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  pr_ab <span class='op'>=</span> <span class='st'>"pr_ab"</span>,
  min_res_mult <span class='op'>=</span> <span class='fl'>10</span>,
  max_res_mult <span class='op'>=</span> <span class='fl'>500</span>,
  num_grids <span class='op'>=</span> <span class='fl'>30</span>,
  n_part <span class='op'>=</span> <span class='fl'>4</span>,
  prop <span class='op'>=</span> <span class='fl'>0.5</span>
<span class='op'>)</span>

<span class='co'># Lets explore Grid object</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>part</span><span class='op'>$</span><span class='va'>grid</span>, col<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grDevices/gray.colors.html'>gray.colors</a></span><span class='op'>(</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span><span class='va'>part</span><span class='op'>$</span><span class='va'>part</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span><span class='op'>]</span>,
       col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/palettes.html'>rainbow</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>[</span><span class='va'>part</span><span class='op'>$</span><span class='va'>part</span><span class='op'>$</span><span class='va'>.part</span><span class='op'>]</span>,
       cex <span class='op'>=</span> <span class='fl'>0.5</span>,
       pch <span class='op'>=</span> <span class='fl'>19</span>
<span class='op'>)</span>


<span class='co'># Now lets learn use these functions with several species</span>
<span class='va'>spp2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>spp</span>, <span class='va'>spp</span><span class='op'>$</span><span class='va'>species</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>spp2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/dimensions.html'>length</a></span><span class='op'>(</span><span class='va'>spp2</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/names.html'>names</a></span><span class='op'>(</span><span class='va'>spp2</span><span class='op'>)</span>

<span class='va'>part_list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>spp2</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'>part_spat</span><span class='op'>(</span>
    env_layer <span class='op'>=</span> <span class='va'>somevar</span>,
    data <span class='op'>=</span> <span class='va'>x</span>,
    x <span class='op'>=</span> <span class='st'>"x"</span>,
    y <span class='op'>=</span> <span class='st'>"y"</span>,
    pr_ab <span class='op'>=</span> <span class='st'>"pr_ab"</span>,
    min_res_mult <span class='op'>=</span> <span class='fl'>10</span>,
    max_res_mult <span class='op'>=</span> <span class='fl'>500</span>,
    num_grids <span class='op'>=</span> <span class='fl'>30</span>,
    n_part <span class='op'>=</span> <span class='fl'>2</span>,
    prop <span class='op'>=</span> <span class='fl'>0.5</span>
  <span class='op'>)</span>
  <span class='va'>result</span>
<span class='op'>}</span><span class='op'>)</span>

<span class='co'># Lets create a single database for all species</span>
<span class='va'>occ_part</span> <span class='op'>&lt;-</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span>
  <span class='va'>part_list</span>,
  <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
<span class='op'>)</span>, .id <span class='op'>=</span> <span class='st'>"species"</span><span class='op'>)</span>
<span class='va'>occ_part</span>

<span class='co'># Lets get a the best grid info for all species</span>
<span class='va'>grid_info</span> <span class='op'>&lt;-</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/bind.html'>bind_rows</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span>
  <span class='va'>part_list</span>,
  <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>[[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>]</span>
<span class='op'>)</span>, .id <span class='op'>=</span> <span class='st'>"species"</span><span class='op'>)</span>

<span class='co'># Lets get a the best grid layer for all species</span>
<span class='va'>grid_layer2</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>grid_layer</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='get_block.html'>get_block</a></span><span class='op'>(</span>env_layer <span class='op'>=</span> <span class='va'>somevar</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, best_grid <span class='op'>=</span> <span class='va'>x</span><span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span>
<span class='va'>grid_layer2</span> <span class='op'>&lt;-</span> <span class='fu'>terra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/rast.html'>rast</a></span><span class='op'>(</span><span class='va'>grid_layer2</span><span class='op'>)</span>
<span class='va'>grid_layer2</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>grid_layer2</span><span class='op'>)</span>


<span class='co'># Block partition for presences-only database</span>
<span class='va'>single_spp</span> <span class='op'>&lt;-</span> <span class='va'>spp</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>species</span> <span class='op'>==</span> <span class='st'>"sp2"</span>, <span class='va'>pr_ab</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>single_spp</span>
<span class='va'>single_spp</span><span class='op'>$</span><span class='va'>pr_ab</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/unique.html'>unique</a></span><span class='op'>(</span><span class='op'>)</span> <span class='co'># only presences</span>

<span class='va'>part</span> <span class='op'>&lt;-</span> <span class='fu'>part_spat</span><span class='op'>(</span>
  env_layer <span class='op'>=</span> <span class='va'>somevar</span>,
  data <span class='op'>=</span> <span class='va'>single_spp</span>,
  x <span class='op'>=</span> <span class='st'>"x"</span>,
  y <span class='op'>=</span> <span class='st'>"y"</span>,
  pr_ab <span class='op'>=</span> <span class='st'>"pr_ab"</span>,
  min_res_mult <span class='op'>=</span> <span class='fl'>10</span>,
  max_res_mult <span class='op'>=</span> <span class='fl'>500</span>,
  num_grids <span class='op'>=</span> <span class='fl'>30</span>,
  n_part <span class='op'>=</span> <span class='fl'>2</span>,
  prop <span class='op'>=</span> <span class='fl'>0.5</span>
<span class='op'>)</span>

<span class='va'>part</span><span class='op'>$</span><span class='va'>part</span>
<span class='va'>part</span><span class='op'>$</span><span class='va'>best_part_info</span>
<span class='va'>part</span><span class='op'>$</span><span class='va'>grid</span>

<span class='fu'><a href='https://rdrr.io/pkg/terra/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>part</span><span class='op'>$</span><span class='va'>grid</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/terra/man/lines.html'>points</a></span><span class='op'>(</span>
  <span class='va'>part</span><span class='op'>$</span><span class='va'>part</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='st'>"y"</span><span class='op'>)</span><span class='op'>]</span>,
  col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/terra/man/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>, <span class='st'>"red"</span><span class='op'>)</span><span class='op'>[</span><span class='va'>part</span><span class='op'>$</span><span class='va'>part</span><span class='op'>$</span><span class='va'>.part</span><span class='op'>]</span>,
  cex <span class='op'>=</span> <span class='fl'>0.5</span>,
  pch <span class='op'>=</span> <span class='fl'>19</span>
<span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Santiago J.E. Velazco, André F.A. Andrade, Brooke Rose, Janet Franklin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


